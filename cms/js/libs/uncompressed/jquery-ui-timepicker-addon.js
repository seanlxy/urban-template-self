/*
 * jQuery timepicker addon
 * By: Trent Richardson [http://trentrichardson.com]
 * Version 1.0.4
 * Last Modified: 09/29/2012
 *
 * Copyright 2012 Trent Richardson
 * You may use this project under MIT or GPL licenses.
 * http://trentrichardson.com/Impromptu/GPL-LICENSE.txt
 * http://trentrichardson.com/Impromptu/MIT-LICENSE.txt
 *
 * HERES THE CSS:
 * .ui-timepicker-div .ui-widget-header { margin-bottom: 8px; }
 * .ui-timepicker-div dl { text-align: left; }
 * .ui-timepicker-div dl dt { height: 25px; margin-bottom: -25px; }
 * .ui-timepicker-div dl dd { margin: 0 10px 10px 65px; }
 * .ui-timepicker-div td { font-size: 90%; }
 * .ui-tpicker-grid-label { background: none; border: none; margin: 0; padding: 0; }
 */

/*jslint evil: true, white: false, undef: false, nomen: false */
(function($){var k="maxDate",a="minDate",e="getDate",l="string",h="timepicker",b="maxDateTime",w="minDateTime",dt="undefined",kt="object",bt="value",wt="option",pt="0",yt=12,vt=10,c="dateFormat",p=":",at="hour",y="+0000",lt=null,ct=!0,v="AM",ht=!1,st="";function Timepicker(){var n=this;n.regional=[],n.regional[st]={currentText:"Now",closeText:"Done",ampm:ht,amNames:[v,"A"],pmNames:["PM","P"],timeFormat:"hh:mm tt",timeSuffix:st,timeOnlyTitle:"Choose Time",timeText:"Time",hourText:"Hour",minuteText:"Minute",secondText:"Second",millisecText:"Millisecond",timezoneText:"Time Zone"},n._defaults={showButtonPanel:ct,timeOnly:ht,showHour:ct,showMinute:ct,showSecond:ht,showMillisec:ht,showTimezone:ht,showTime:ct,stepHour:1,stepMinute:1,stepSecond:1,stepMillisec:1,hour:0,minute:0,second:0,millisec:0,timezone:lt,useLocalTimezone:ht,defaultTimezone:y,hourMin:0,minuteMin:0,secondMin:0,millisecMin:0,hourMax:23,minuteMax:59,secondMax:59,millisecMax:999,minDateTime:lt,maxDateTime:lt,onSelect:lt,hourGrid:0,minuteGrid:0,secondGrid:0,millisecGrid:0,alwaysSetTime:ct,separator:" ",altFieldTimeOnly:ct,altSeparator:lt,altTimeSuffix:lt,showTimepicker:ct,timezoneIso8601:ht,timezoneList:lt,addSliderAccess:ht,sliderAccessArgs:lt,defaultValue:lt},$.extend(n._defaults,n.regional[st])}function extendRemove(n,t){$.extend(n,t);for(var i in t)(t[i]===lt||t[i]===undefined)&&(n[i]=t[i]);return n}if($.ui.timepicker=$.ui.timepicker||{},!$.ui.timepicker.version){$.extend($.ui,{timepicker:{version:"1.0.4"}}),$.extend(Timepicker.prototype,{$input:lt,$altInput:lt,$timeObj:lt,inst:lt,hour_slider:lt,minute_slider:lt,second_slider:lt,millisec_slider:lt,timezone_select:lt,hour:0,minute:0,second:0,millisec:0,timezone:lt,defaultTimezone:y,hourMinOriginal:lt,minuteMinOriginal:lt,secondMinOriginal:lt,millisecMinOriginal:lt,hourMaxOriginal:lt,minuteMaxOriginal:lt,secondMaxOriginal:lt,millisecMaxOriginal:lt,ampm:st,formattedDate:st,formattedTime:st,formattedDateTime:st,timezoneList:lt,units:[at,"minute","second","millisec"],setDefaults:function(n){return extendRemove(this._defaults,n||{}),this},_newInst:function($input,o){var tp_inst=new Timepicker,inlineSettings={},attrName,attrValue,timezoneList;for(attrName in this._defaults)if(this._defaults.hasOwnProperty(attrName)&&(attrValue=$input.attr("time:"+attrName),attrValue))try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}return tp_inst._defaults=$.extend({},this._defaults,inlineSettings,o,{beforeShow:function(n,t){if($.isFunction(o.beforeShow))return o.beforeShow(n,t,tp_inst)},onChangeMonthYear:function(n,t,i){tp_inst._updateDateTime(i),$.isFunction(o.onChangeMonthYear)&&o.onChangeMonthYear.call($input[0],n,t,i,tp_inst)},onClose:function(n,t){tp_inst.timeDefined===ct&&$input.val()!==st&&tp_inst._updateDateTime(t),$.isFunction(o.onClose)&&o.onClose.call($input[0],n,t,tp_inst)},timepicker:tp_inst}),tp_inst.amNames=$.map(tp_inst._defaults.amNames,function(n){return n.toUpperCase()}),tp_inst.pmNames=$.map(tp_inst._defaults.pmNames,function(n){return n.toUpperCase()}),tp_inst._defaults.timezoneList===null&&(timezoneList=["-1200","-1100","-1000","-0930","-0900","-0800","-0700","-0600","-0500","-0430","-0400","-0330","-0300","-0200","-0100","+0000","+0100","+0200","+0300","+0330","+0400","+0430","+0500","+0530","+0545","+0600","+0630","+0700","+0800","+0845","+0900","+0930","+1000","+1030","+1100","+1130","+1200","+1245","+1300","+1400"],tp_inst._defaults.timezoneIso8601&&(timezoneList=$.map(timezoneList,function(n){return n==y?"Z":n.substring(0,3)+p+n.substring(3)})),tp_inst._defaults.timezoneList=timezoneList),tp_inst.timezone=tp_inst._defaults.timezone,tp_inst.hour=tp_inst._defaults.hour,tp_inst.minute=tp_inst._defaults.minute,tp_inst.second=tp_inst._defaults.second,tp_inst.millisec=tp_inst._defaults.millisec,tp_inst.ampm="",tp_inst.$input=$input,o.altField&&(tp_inst.$altInput=$(o.altField).css({cursor:"pointer"}).focus(function(){$input.trigger("focus")})),(tp_inst._defaults.minDate===0||tp_inst._defaults.minDateTime===0)&&(tp_inst._defaults.minDate=new Date),(tp_inst._defaults.maxDate===0||tp_inst._defaults.maxDateTime===0)&&(tp_inst._defaults.maxDate=new Date),tp_inst._defaults.minDate!==undefined&&tp_inst._defaults.minDate instanceof Date&&(tp_inst._defaults.minDateTime=new Date(tp_inst._defaults.minDate.getTime())),tp_inst._defaults.minDateTime!==undefined&&tp_inst._defaults.minDateTime instanceof Date&&(tp_inst._defaults.minDate=new Date(tp_inst._defaults.minDateTime.getTime())),tp_inst._defaults.maxDate!==undefined&&tp_inst._defaults.maxDate instanceof Date&&(tp_inst._defaults.maxDateTime=new Date(tp_inst._defaults.maxDate.getTime())),tp_inst._defaults.maxDateTime!==undefined&&tp_inst._defaults.maxDateTime instanceof Date&&(tp_inst._defaults.maxDate=new Date(tp_inst._defaults.maxDateTime.getTime())),tp_inst.$input.bind("focus",function(){tp_inst._onFocus()}),tp_inst},_addTimePicker:function(n){var t=this,i=t.$altInput&&t._defaults.altFieldTimeOnly?t.$input.val()+" "+t.$altInput.val():t.$input.val();t.timeDefined=t._parseTime(i),t._limitMinMaxDateTime(n,ht),t._injectTimePicker()},_parseTime:function(n,t){var i=this,f,u,r;if(i.inst||(i.inst=$.datepicker._getInst(i.$input[0])),t||!i._defaults.timeOnly){f=$.datepicker._get(i.inst,c);try{if(u=parseDateTimeInternal(f,i._defaults.timeFormat,n,$.datepicker._getFormatConfig(i.inst),i._defaults),!u.timeObj)return ht;$.extend(i,u.timeObj)}catch(e){return ht}return ct}return(r=$.datepicker.parseTime(i._defaults.timeFormat,n,i._defaults),!r)?ht:($.extend(i,r),ct)},_injectTimePicker:function(){var b="horizontal",w="slide",ut='<td data-for="',v="Grid",k="show",p="Min",tt="</dt>",t=this,g=t.inst.dpDiv,n=t.inst.settings,r=t,i=st,l=st,e={},a={},nt=lt,c,f,h,s,y,u,o,d,ot,et,it,rt,ft;if(g.find("div.ui-timepicker-div").length===0&&n.showTimepicker){for(c=' style="display:none;"',f='<div class="ui-timepicker-div"><dl><dt class="ui_tpicker_time_label"'+(n.showTime?st:c)+">"+n.timeText+tt+'<dd class="ui_tpicker_time"'+(n.showTime?st:c)+"></dd>",o=0,d=t.units.length;o<d;o++){if(i=t.units[o],l=i.substr(0,1).toUpperCase()+i.substr(1),e[i]=parseInt(n[i+"Max"]-(n[i+"Max"]-n[i+p])%n["step"+l],vt),a[i]=0,f+='<dt class="ui_tpicker_'+i+'_label"'+(n[k+l]?st:c)+">"+n[i+"Text"]+tt+'<dd class="ui_tpicker_'+i+'"><div class="ui_tpicker_'+i+'_slider"'+(n[k+l]?st:c)+"></div>",n[k+l]&&n[i+v]>0){if(f+='<div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>',i==at)for(h=n[i+p];h<=e[i];h+=parseInt(n[i+v],vt))a[i]++,s=n.ampm&&h>yt?h-yt:h,s<vt&&(s=pt+s),n.ampm&&(h===0?s=yt+"a":s+=h<yt?"a":"p"),f+=ut+i+'">'+s+"</td>";else for(y=n[i+p];y<=e[i];y+=parseInt(n[i+v],vt))a[i]++,f+=ut+i+'">'+(y<vt?pt:st)+y+"</td>";f+="</tr></table></div>"}f+="</dd>"}for(f+='<dt class="ui_tpicker_timezone_label"'+(n.showTimezone?st:c)+">"+n.timezoneText+tt,f+='<dd class="ui_tpicker_timezone" '+(n.showTimezone?st:c)+"></dd>",f+="</dl></div>",u=$(f),n.timeOnly===ct&&(u.prepend('<div class="ui-widget-header ui-helper-clearfix ui-corner-all"><div class="ui-datepicker-title">'+n.timeOnlyTitle+"</div></div>"),g.find(".ui-datepicker-header, .ui-datepicker-calendar").hide()),t.hour_slider=u.find(".ui_tpicker_hour_slider").prop(w,lt).slider({orientation:b,value:t.hour,min:n.hourMin,max:e.hour,step:n.stepHour,slide:function(n,t){r.hour_slider.slider(wt,bt,t.value),r._onTimeChange()},stop:function(){r._onSelectHandler()}}),t.minute_slider=u.find(".ui_tpicker_minute_slider").prop(w,lt).slider({orientation:b,value:t.minute,min:n.minuteMin,max:e.minute,step:n.stepMinute,slide:function(n,t){r.minute_slider.slider(wt,bt,t.value),r._onTimeChange()},stop:function(){r._onSelectHandler()}}),t.second_slider=u.find(".ui_tpicker_second_slider").prop(w,lt).slider({orientation:b,value:t.second,min:n.secondMin,max:e.second,step:n.stepSecond,slide:function(n,t){r.second_slider.slider(wt,bt,t.value),r._onTimeChange()},stop:function(){r._onSelectHandler()}}),t.millisec_slider=u.find(".ui_tpicker_millisec_slider").prop(w,lt).slider({orientation:b,value:t.millisec,min:n.millisecMin,max:e.millisec,step:n.stepMillisec,slide:function(n,t){r.millisec_slider.slider(wt,bt,t.value),r._onTimeChange()},stop:function(){r._onSelectHandler()}}),o=0,d=r.units.length;o<d;o++)i=r.units[o],l=i.substr(0,1).toUpperCase()+i.substr(1),n[k+l]&&n[i+v]>0&&(nt=100*a[i]*n[i+v]/(e[i]-n[i+p]),u.find(".ui_tpicker_"+i+" table").css({width:nt+"%",marginLeft:nt/(-2*a[i])+"%",borderCollapse:"collapse"}).find("td").click(function(){var f=$(this),i=f.html(),o=f.data("for"),e,u;o==at&&n.ampm&&(e=i.substring(2).toLowerCase(),u=parseInt(i.substring(0,2),vt),i=e=="a"?u==yt?0:u:u==yt?yt:u+yt),r[o+"_slider"].slider(wt,bt,parseInt(i,vt)),r._onTimeChange(),r._onSelectHandler()}).css({cursor:"pointer",width:100/a[i]+"%",textAlign:"center",overflow:"hidden"}));t.timezone_select=u.find(".ui_tpicker_timezone").append("<select></select>").find("select"),$.fn.append.apply(t.timezone_select,$.map(n.timezoneList,function(n){return $("<option />").val(typeof n==kt?n.value:n).text(typeof n==kt?n.label:n)})),typeof t.timezone!=dt&&t.timezone!==lt&&t.timezone!==st?(ot=new Date(t.inst.selectedYear,t.inst.selectedMonth,t.inst.selectedDay,yt),et=$.timepicker.timeZoneOffsetString(ot),et==t.timezone?selectLocalTimeZone(r):t.timezone_select.val(t.timezone)):typeof t.hour!=dt&&t.hour!==lt&&t.hour!==st?t.timezone_select.val(n.defaultTimezone):selectLocalTimeZone(r),t.timezone_select.change(function(){r._defaults.useLocalTimezone=ht,r._onTimeChange()}),it=g.find(".ui-datepicker-buttonpane"),it.length?it.before(u):g.append(u),t.$timeObj=u.find(".ui_tpicker_time"),t.inst!==lt&&(rt=t.timeDefined,t._onTimeChange(),t.timeDefined=rt),t._defaults.addSliderAccess&&(ft=t._defaults.sliderAccessArgs,setTimeout(function(){if(u.find(".ui-slider-access").length===0){u.find(".ui-slider:visible").sliderAccess(ft);var n=u.find(".ui-slider-access:eq(0)").outerWidth(ct);n&&u.find("table:visible").each(function(){var t=$(this),r=t.outerWidth(),f=t.css("marginLeft").toString().replace("%",st),i=r-n,u=f*i/r+"%";t.css({width:i,marginLeft:u})})}},vt))}},_limitMinMaxDateTime:function(n,t){var i=this,r=i._defaults,e=new Date(n.selectedYear,n.selectedMonth,n.selectedDay),u,s,f,o;if(i._defaults.showTimepicker&&($.datepicker._get(n,w)!==lt&&$.datepicker._get(n,w)!==undefined&&e&&(u=$.datepicker._get(n,w),s=new Date(u.getFullYear(),u.getMonth(),u.getDate(),0,0,0,0),(i.hourMinOriginal===lt||i.minuteMinOriginal===lt||i.secondMinOriginal===lt||i.millisecMinOriginal===lt)&&(i.hourMinOriginal=r.hourMin,i.minuteMinOriginal=r.minuteMin,i.secondMinOriginal=r.secondMin,i.millisecMinOriginal=r.millisecMin),n.settings.timeOnly||s.getTime()==e.getTime()?(i._defaults.hourMin=u.getHours(),i.hour<=i._defaults.hourMin?(i.hour=i._defaults.hourMin,i._defaults.minuteMin=u.getMinutes(),i.minute<=i._defaults.minuteMin?(i.minute=i._defaults.minuteMin,i._defaults.secondMin=u.getSeconds(),i.second<=i._defaults.secondMin?(i.second=i._defaults.secondMin,i._defaults.millisecMin=u.getMilliseconds()):(i.millisec<i._defaults.millisecMin&&(i.millisec=i._defaults.millisecMin),i._defaults.millisecMin=i.millisecMinOriginal)):(i._defaults.secondMin=i.secondMinOriginal,i._defaults.millisecMin=i.millisecMinOriginal)):(i._defaults.minuteMin=i.minuteMinOriginal,i._defaults.secondMin=i.secondMinOriginal,i._defaults.millisecMin=i.millisecMinOriginal)):(i._defaults.hourMin=i.hourMinOriginal,i._defaults.minuteMin=i.minuteMinOriginal,i._defaults.secondMin=i.secondMinOriginal,i._defaults.millisecMin=i.millisecMinOriginal)),$.datepicker._get(n,b)!==lt&&$.datepicker._get(n,b)!==undefined&&e&&(f=$.datepicker._get(n,b),o=new Date(f.getFullYear(),f.getMonth(),f.getDate(),0,0,0,0),(i.hourMaxOriginal===lt||i.minuteMaxOriginal===lt||i.secondMaxOriginal===lt)&&(i.hourMaxOriginal=r.hourMax,i.minuteMaxOriginal=r.minuteMax,i.secondMaxOriginal=r.secondMax,i.millisecMaxOriginal=r.millisecMax),n.settings.timeOnly||o.getTime()==e.getTime()?(i._defaults.hourMax=f.getHours(),i.hour>=i._defaults.hourMax?(i.hour=i._defaults.hourMax,i._defaults.minuteMax=f.getMinutes(),i.minute>=i._defaults.minuteMax?(i.minute=i._defaults.minuteMax,i._defaults.secondMax=f.getSeconds()):i.second>=i._defaults.secondMax?(i.second=i._defaults.secondMax,i._defaults.millisecMax=f.getMilliseconds()):(i.millisec>i._defaults.millisecMax&&(i.millisec=i._defaults.millisecMax),i._defaults.millisecMax=i.millisecMaxOriginal)):(i._defaults.minuteMax=i.minuteMaxOriginal,i._defaults.secondMax=i.secondMaxOriginal,i._defaults.millisecMax=i.millisecMaxOriginal)):(i._defaults.hourMax=i.hourMaxOriginal,i._defaults.minuteMax=i.minuteMaxOriginal,i._defaults.secondMax=i.secondMaxOriginal,i._defaults.millisecMax=i.millisecMaxOriginal)),t!==undefined&&t===ct)){var l=parseInt(i._defaults.hourMax-(i._defaults.hourMax-i._defaults.hourMin)%i._defaults.stepHour,vt),c=parseInt(i._defaults.minuteMax-(i._defaults.minuteMax-i._defaults.minuteMin)%i._defaults.stepMinute,vt),a=parseInt(i._defaults.secondMax-(i._defaults.secondMax-i._defaults.secondMin)%i._defaults.stepSecond,vt),h=parseInt(i._defaults.millisecMax-(i._defaults.millisecMax-i._defaults.millisecMin)%i._defaults.stepMillisec,vt);i.hour_slider&&i.hour_slider.slider(wt,{min:i._defaults.hourMin,max:l}).slider(bt,i.hour),i.minute_slider&&i.minute_slider.slider(wt,{min:i._defaults.minuteMin,max:c}).slider(bt,i.minute),i.second_slider&&i.second_slider.slider(wt,{min:i._defaults.secondMin,max:a}).slider(bt,i.second),i.millisec_slider&&i.millisec_slider.slider(wt,{min:i._defaults.millisecMin,max:h}).slider(bt,i.millisec)}},_onTimeChange:function(){var n=this,t=n.hour_slider?n.hour_slider.slider(bt):ht,i=n.minute_slider?n.minute_slider.slider(bt):ht,u=n.second_slider?n.second_slider.slider(bt):ht,r=n.millisec_slider?n.millisec_slider.slider(bt):ht,f=n.timezone_select?n.timezone_select.val():ht,e=n._defaults,s,o;typeof t==kt&&(t=ht),typeof i==kt&&(i=ht),typeof u==kt&&(u=ht),typeof r==kt&&(r=ht),typeof f==kt&&(f=ht),t!==ht&&(t=parseInt(t,vt)),i!==ht&&(i=parseInt(i,vt)),u!==ht&&(u=parseInt(u,vt)),r!==ht&&(r=parseInt(r,vt)),s=e[t<yt?"amNames":"pmNames"][0],o=t!=n.hour||i!=n.minute||u!=n.second||r!=n.millisec||n.ampm.length>0&&t<yt!=($.inArray(n.ampm.toUpperCase(),n.amNames)!==-1)||n.timezone===lt&&f!=n.defaultTimezone||n.timezone!==lt&&f!=n.timezone,o&&(t!==ht&&(n.hour=t),i!==ht&&(n.minute=i),u!==ht&&(n.second=u),r!==ht&&(n.millisec=r),f!==ht&&(n.timezone=f),n.inst||(n.inst=$.datepicker._getInst(n.$input[0])),n._limitMinMaxDateTime(n.inst,ct)),e.ampm&&(n.ampm=s),n.formattedTime=$.datepicker.formatTime(n._defaults.timeFormat,n,n._defaults),n.$timeObj&&n.$timeObj.text(n.formattedTime+e.timeSuffix),n.timeDefined=ct,o&&n._updateDateTime()},_onSelectHandler:function(){var n=this,t=n._defaults.onSelect||n.inst.settings.onSelect,i=n.$input?n.$input[0]:lt;t&&i&&t.apply(i,[n.formattedDateTime,n])},_formatTime:function(n,t){var i=this;n=n||{hour:i.hour,minute:i.minute,second:i.second,millisec:i.millisec,ampm:i.ampm,timezone:i.timezone};var r=(t||i._defaults.timeFormat).toString();if(r=$.datepicker.formatTime(r,n,i._defaults),arguments.length)return r;i.formattedTime=r},_updateDateTime:function(n){var t=this,r;n=t.inst||n;var u=$.datepicker._daylightSavingAdjust(new Date(n.selectedYear,n.selectedMonth,n.selectedDay)),s=$.datepicker._get(n,c),e=$.datepicker._getFormatConfig(n),o=u!==lt&&t.timeDefined;if(t.formattedDate=$.datepicker.formatDate(s,u===lt?new Date:u,e),r=t.formattedDate,t._defaults.timeOnly===ct?r=t.formattedTime:t._defaults.timeOnly!==ct&&(t._defaults.alwaysSetTime||o)&&(r+=t._defaults.separator+t.formattedTime+t._defaults.timeSuffix),t.formattedDateTime=r,t._defaults.showTimepicker)if(t.$altInput&&t._defaults.altFieldTimeOnly===ct)t.$altInput.val(t.formattedTime),t.$input.val(t.formattedDate);else if(t.$altInput){t.$input.val(r);var i=st,h=t._defaults.altSeparator?t._defaults.altSeparator:t._defaults.separator,f=t._defaults.altTimeSuffix?t._defaults.altTimeSuffix:t._defaults.timeSuffix;i=t._defaults.altFormat?$.datepicker.formatDate(t._defaults.altFormat,u===lt?new Date:u,e):t.formattedDate,i&&(i+=h),i+=t._defaults.altTimeFormat?$.datepicker.formatTime(t._defaults.altTimeFormat,t,t._defaults)+f:t.formattedTime+f,t.$altInput.val(i)}else t.$input.val(r);else t.$input.val(t.formattedDate);t.$input.trigger("change")},_onFocus:function(){var n=this;if(!n.$input.val()&&n._defaults.defaultValue){n.$input.val(n._defaults.defaultValue);var t=$.datepicker._getInst(n.$input.get(0)),i=$.datepicker._get(t,h);if(i&&i._defaults.timeOnly&&t.input.val()!=t.lastVal)try{$.datepicker._updateDatepicker(t)}catch(r){$.datepicker.log(r)}}}}),$.fn.extend({timepicker:function(n){n=n||{};var t=Array.prototype.slice.call(arguments);return typeof n==kt&&(t[0]=$.extend(n,{timeOnly:ct})),$(this).each(function(){$.fn.datetimepicker.apply($(this),t)})},datetimepicker:function(n){n=n||{};var t=arguments;return typeof n==l?n==e?$.fn.datepicker.apply($(this[0]),t):this.each(function(){var n=$(this);n.datepicker.apply(n,t)}):this.each(function(){var t=$(this);t.datepicker($.timepicker._newInst(t,n)._defaults)})}}),$.datepicker.parseDateTime=function(n,t,i,r,u){var e=parseDateTimeInternal(n,t,i,r,u),f;return e.timeObj&&(f=e.timeObj,e.date.setHours(f.hour,f.minute,f.second,f.millisec)),e.date},$.datepicker.parseTime=function(n,t,i){var h="(\\d?\\d)",l=function(n,t){var i=[];return n&&$.merge(i,n),t&&$.merge(i,t),i=$.map(i,function(n){return n.replace(/[.*+?|()\[\]{}\\]/g,"\\$&")}),"("+i.join("|")+")?"},a=function(n){var i=n.toLowerCase().match(/(h{1,2}|m{1,2}|s{1,2}|l{1}|t{1,2}|z)/g),r={h:-1,m:-1,s:-1,l:-1,t:-1,z:-1},t;if(i)for(t=0;t<i.length;t++)r[i[t].toString().charAt(0)]==-1&&(r[i[t].toString().charAt(0)]=t+1);return r},o=extendRemove(extendRemove({},$.timepicker._defaults),i||{}),c="^"+n.toString().replace(/h{1,2}/ig,h).replace(/m{1,2}/ig,h).replace(/s{1,2}/ig,h).replace(/l{1}/ig,"(\\d?\\d?\\d)").replace(/t{1,2}/ig,l(o.amNames,o.pmNames)).replace(/z{1}/ig,"(z|[-+]\\d\\d:?\\d\\d|\\S+)?").replace(/\s/g,"\\s?")+o.timeSuffix+"$",r=a(n),s=st,u,e,f;if(u=t.match(new RegExp(c,"i")),e={hour:0,minute:0,second:0,millisec:0},u){if(r.t!==-1&&(u[r.t]===undefined||u[r.t].length===0?(s=st,e.ampm=st):(s=$.inArray(u[r.t].toUpperCase(),o.amNames)!==-1?v:"PM",e.ampm=o[s==v?"amNames":"pmNames"][0])),r.h!==-1&&(e.hour=s==v&&u[r.h]=="12"?0:s=="PM"&&u[r.h]!="12"?parseInt(u[r.h],vt)+yt:Number(u[r.h])),r.m!==-1&&(e.minute=Number(u[r.m])),r.s!==-1&&(e.second=Number(u[r.s])),r.l!==-1&&(e.millisec=Number(u[r.l])),r.z!==-1&&u[r.z]!==undefined){f=u[r.z].toUpperCase();switch(f.length){case 1:f=o.timezoneIso8601?"Z":y;break;case 5:o.timezoneIso8601&&(f=f.substring(1)=="0000"?"Z":f.substring(0,3)+p+f.substring(3));break;case 6:o.timezoneIso8601?f.substring(1)=="00:00"&&(f="Z"):f=f=="Z"||f.substring(1)=="00:00"?y:f.replace(/:/,st)}e.timezone=f}return e}return ht},$.datepicker.formatTime=function(n,t,i){i=i||{},i=$.extend({},$.timepicker._defaults,i),t=$.extend({hour:0,minute:0,second:0,millisec:0,timezone:y},t);var u=n,f=i.amNames[0],r=parseInt(t.hour,vt);return i.ampm&&(r>11&&(f=i.pmNames[0],r>yt&&(r=r%yt)),r===0&&(r=yt)),u=u.replace(/(?:hh?|mm?|ss?|[tT]{1,2}|[lz]|('.*?'|".*?"))/g,function(n){switch(n.toLowerCase()){case"hh":return(pt+r).slice(-2);case"h":return r;case"mm":return(pt+t.minute).slice(-2);case"m":return t.minute;case"ss":return(pt+t.second).slice(-2);case"s":return t.second;case"l":return("00"+t.millisec).slice(-3);case"z":return t.timezone===lt?i.defaultTimezone:t.timezone;case"t":case"tt":return i.ampm?(n.length==1&&(f=f.charAt(0)),n.charAt(0)==="T"?f.toUpperCase():f.toLowerCase()):st;default:return n.replace(/\'/g,st)||"'"}}),u=$.trim(u)},$.datepicker._base_selectDate=$.datepicker._selectDate,$.datepicker._selectDate=function(n,t){var r=this,i=r._getInst($(n)[0]),u=r._get(i,h);u?(u._limitMinMaxDateTime(i,ct),i.inline=i.stay_open=ct,r._base_selectDate(n,t),i.inline=i.stay_open=ht,r._notifyChange(i),r._updateDatepicker(i)):r._base_selectDate(n,t)},$.datepicker._base_updateDatepicker=$.datepicker._updateDatepicker,$.datepicker._updateDatepicker=function(n){var r=n.input[0],t,i;$.datepicker._curInst&&$.datepicker._curInst!=n&&$.datepicker._datepickerShowing&&$.datepicker._lastInput!=r||(typeof n.stay_open!="boolean"||n.stay_open===ht)&&(this._base_updateDatepicker(n),t=this._get(n,h),t&&(t._addTimePicker(n),t._defaults.useLocalTimezone&&(i=new Date(n.selectedYear,n.selectedMonth,n.selectedDay,yt),selectLocalTimeZone(t,i),t._onTimeChange())))},$.datepicker._base_doKeyPress=$.datepicker._doKeyPress,$.datepicker._doKeyPress=function(n){var r=$.datepicker._getInst(n.target),t=$.datepicker._get(r,h);if(t&&$.datepicker._get(r,"constrainInput")){var i=t._defaults.ampm,f=$.datepicker._possibleChars($.datepicker._get(r,c)),e=t._defaults.timeFormat.toString().replace(/[hms]/g,st).replace(/TT/g,i?"APM":st).replace(/Tt/g,i?"AaPpMm":st).replace(/tT/g,i?"AaPpMm":st).replace(/T/g,i?"AP":st).replace(/tt/g,i?"apm":st).replace(/t/g,i?"ap":st)+" "+t._defaults.separator+t._defaults.timeSuffix+(t._defaults.showTimezone?t._defaults.timezoneList.join(st):st)+t._defaults.amNames.join(st)+t._defaults.pmNames.join(st)+f,u=String.fromCharCode(n.charCode===undefined?n.keyCode:n.charCode);return n.ctrlKey||u<" "||!f||e.indexOf(u)>-1}return $.datepicker._base_doKeyPress(n)},$.datepicker._base_doKeyUp=$.datepicker._doKeyUp,$.datepicker._doKeyUp=function(n){var t=$.datepicker._getInst(n.target),i=$.datepicker._get(t,h);if(i&&i._defaults.timeOnly&&t.input.val()!=t.lastVal)try{$.datepicker._updateDatepicker(t)}catch(r){$.datepicker.log(r)}return $.datepicker._base_doKeyUp(n)},$.datepicker._base_gotoToday=$.datepicker._gotoToday,$.datepicker._gotoToday=function(n){var t=this,i=t._getInst($(n)[0]),f=i.dpDiv,u,r;t._base_gotoToday(n),u=t._get(i,h),selectLocalTimeZone(u),r=new Date,t._setTime(i,r),$(".ui-datepicker-today",f).click()},$.datepicker._disableTimepickerDatepicker=function(n){var i=this._getInst(n),t;i&&(t=this._get(i,h),$(n).datepicker(e),t&&(t._defaults.showTimepicker=ht,t._updateDateTime(i)))},$.datepicker._enableTimepickerDatepicker=function(n){var i=this._getInst(n),t;i&&(t=this._get(i,h),$(n).datepicker(e),t&&(t._defaults.showTimepicker=ct,t._addTimePicker(i),t._updateDateTime(i)))},$.datepicker._setTime=function(n,t){var i=this._get(n,h),r;i&&(r=i._defaults,i.hour=t?t.getHours():r.hour,i.minute=t?t.getMinutes():r.minute,i.second=t?t.getSeconds():r.second,i.millisec=t?t.getMilliseconds():r.millisec,i._limitMinMaxDateTime(n,ct),i._onTimeChange(),i._updateDateTime(n))},$.datepicker._setTimeDatepicker=function(n,t,i){var f=this,e=f._getInst(n),r,u;e&&(r=f._get(e,h),r&&(f._setDateFromField(e),t&&(typeof t==l?(r._parseTime(t,i),u=new Date,u.setHours(r.hour,r.minute,r.second,r.millisec)):u=new Date(t.getTime()),u.toString()=="Invalid Date"&&(u=undefined),f._setTime(e,u))))},$.datepicker._base_setDateDatepicker=$.datepicker._setDateDatepicker,$.datepicker._setDateDatepicker=function(n,t){var i=this,r=i._getInst(n),u;r&&(u=t instanceof Date?new Date(t.getTime()):t,i._updateDatepicker(r),i._base_setDateDatepicker.apply(i,arguments),i._setTimeDatepicker(n,u,ct))},$.datepicker._base_getDateDatepicker=$.datepicker._getDateDatepicker,$.datepicker._getDateDatepicker=function(n,t){var r=this,u=r._getInst(n),i,f;if(u)return(i=r._get(u,h),i)?(u.lastVal===undefined&&r._setDateFromField(u,t),f=r._getDate(u),f&&i._parseTime($(n).val(),i.timeOnly)&&f.setHours(i.hour,i.minute,i.second,i.millisec),f):r._base_getDateDatepicker(n,t)},$.datepicker._base_parseDate=$.datepicker.parseDate,$.datepicker.parseDate=function(n,t,i){var r;try{r=this._base_parseDate(n,t,i)}catch(u){r=this._base_parseDate(n,t.substring(0,t.length-(u.length-u.indexOf(p)-2)),i)}return r},$.datepicker._base_formatDate=$.datepicker._formatDate,$.datepicker._formatDate=function(n){var u=this._get(n,h);return u?(u._updateDateTime(n),u.$input.val()):this._base_formatDate(n)},$.datepicker._base_optionDatepicker=$.datepicker._optionDatepicker,$.datepicker._optionDatepicker=function(n,t,i){var e=this,s=e._getInst(n),f;if(!s)return lt;if(f=e._get(s,h),f){var r=lt,u=lt,o=lt;typeof t==l?t===a||t===w?r=i:t===k||t===b?u=i:t==="onSelect"&&(o=i):typeof t==kt&&(t.minDate?r=t.minDate:t.minDateTime?r=t.minDateTime:t.maxDate?u=t.maxDate:t.maxDateTime&&(u=t.maxDateTime)),r?(r=r===0?new Date:new Date(r),f._defaults.minDate=r,f._defaults.minDateTime=r):u?(u=u===0?new Date:new Date(u),f._defaults.maxDate=u,f._defaults.maxDateTime=u):o&&(f._defaults.onSelect=o)}return i===undefined?e._base_optionDatepicker(n,t):e._base_optionDatepicker(n,t,i)};var splitDateTime=function(n,t,i,r){var f,l;try{var u=r&&r.separator?r.separator:$.timepicker._defaults.separator,c=r&&r.timeFormat?r.timeFormat:$.timepicker._defaults.timeFormat,a=r&&r.ampm?r.ampm:$.timepicker._defaults.ampm,o=c.split(u),s=o.length,e=t.split(u),h=e.length;if(a||(o=$.trim(c.replace(/t/gi,st)).split(u),s=o.length),h>1)return[e.splice(0,h-s).join(u),e.splice(0,s).join(u)]}catch(v){if(v.indexOf(p)>=0)return f=t.length-(v.length-v.indexOf(p)-2),l=t.substring(f),[$.trim(t.substring(0,f)),$.trim(t.substring(f))];throw v;}return[t,st]},parseDateTimeInternal=function(n,t,i,r,u){var o,e=splitDateTime(n,i,r,u),s,f;if(o=$.datepicker._base_parseDate(n,e[0],r),e[1]!==st){if(s=e[1],f=$.datepicker.parseTime(t,s,u),f===lt)throw"Wrong time format";return{date:o,timeObj:f}}return{date:o}},selectLocalTimeZone=function(n,t){if(n&&n.timezone_select){n._defaults.useLocalTimezone=ct;var r=typeof t!=dt?t:new Date,i=$.timepicker.timeZoneOffsetString(r);n._defaults.timezoneIso8601&&(i=i.substring(0,3)+p+i.substring(3)),n.timezone_select.val(i)}};$.timepicker=new Timepicker,$.timepicker.timeZoneOffsetString=function(n){var t=n.getTimezoneOffset()*-1,i=t%60,r=(t-i)/60;return(t>=0?"+":"-")+(pt+(r*101).toString()).substr(-2)+(pt+(i*101).toString()).substr(-2)},$.timepicker.timeRange=function(n,t,i){return $.timepicker.handleRange(h,n,t,i)},$.timepicker.dateTimeRange=function(n,t,i){$.timepicker.dateRange(n,t,i,"datetimepicker")},$.timepicker.dateRange=function(n,t,i,r){r=r||"datepicker",$.timepicker.handleRange(r,n,t,i)},$.timepicker.handleRange=function(n,t,i,r){function f(n,r,u){r.val()&&new Date(t.val())>new Date(i.val())&&r.val(u)}function u(t,i,r){if($(t).val()){var u=$(t)[n].call($(t),e);u.getTime&&$(i)[n].call($(i),wt,r,u)}}return $.fn[n].call(t,$.extend({onClose:function(n){f(this,i,n)},onSelect:function(){u(this,i,a)}},r,r.start)),$.fn[n].call(i,$.extend({onClose:function(n){f(this,t,n)},onSelect:function(){u(this,t,k)}},r,r.end)),n!=h&&r.reformat&&$([t,i]).each(function(){var t=this,r=$(t)[n].call($(t),wt,c),i=new Date($(t).val());$(t).val()&&i&&$(t).val($.datepicker.formatDate(r,i))}),f(t,i,t.val()),u(t,i,a),u(i,t,k),$([t.get(0),i.get(0)])},$.timepicker.version="1.0.4"}})(jQuery);